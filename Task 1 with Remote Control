#include <Servo.h>
#include "IRremote.h"

#define trig 12
#define echo 11 
#define ENABLE 5
#define DIRA 3
#define DIRB 4

int pos = 90;
int moveServo;
double distance, duration;
//Signal Pin of IR receiver to Arduino Digital
  int receiver = 13;
  
Servo myservo;
//Create instance of 'irrecv':  
  IRrecv irrecv(receiver);
//Create instance of 'decode_results':  
  decode_results results;
  
void setup(){
  Serial.begin(9600);
  myservo.attach(9); 
  myservo.write(pos);
  //Start the receiver
  irrecv.enableIRIn();
  pinMode(trig,OUTPUT);
  pinMode(echo,INPUT);
  pinMode(ENABLE,OUTPUT);
  pinMode(DIRA,OUTPUT);
  pinMode(DIRB,OUTPUT);
} 

void loop(){
  digitalWrite(DIRB,LOW);
  digitalWrite(DIRA,LOW);
  analogWrite(ENABLE,LOW);


  //Has the IR signal been received?
  if (irrecv.decode(&results)) 
  {
    switch(results.value)
    {

//>> button pressed:
  case 0xFF02FD:
  
    moveServo=map(receiver,-512,512,-90,90);
    myservo.write(moveServo);
    delay(500);
    break;
  

//<< button pressed:
 case 0xFF22DD:
  
    moveServo=map(receiver,-512,512,-90,90);
    myservo.write(-moveServo);
    delay(500);
    break;
  
  
 //VOL+ button pressed:
  case 0xFFA857:
    digitalWrite(DIRB,LOW);
    digitalWrite(DIRA,HIGH);
    analogWrite(ENABLE, map(receiver,0,1023,0,255));
     
     delay(500);
    break;
  

//VOL- button pressed:
  case 0xFF629D:
  
    digitalWrite(DIRB,HIGH);
    digitalWrite(DIRA,LOW);
    analogWrite(ENABLE, map(receiver,0,1023,0,255));
    delay(500);
    break;
  }
  
//Receive the next value:  
  irrecv.resume(); 

  }
  
}

  double dist_calc()
{
  digitalWrite(trig,LOW);
  delayMicroseconds(2);
  digitalWrite(trig,HIGH);
  delayMicroseconds(10);
  digitalWrite(trig,LOW);
  duration = pulseIn(echo,HIGH); 
  distance = 100.0*(343.0*(duration/2.0))/1000000.0; 
  return (distance);
}
